<div class="container mt-4">
    <h2>Gesti√≥n de Ganado</h2>
  
    <!-- Bot√≥n para abrir el modal de agregar -->
    <button
      class="btn btn-primary"
      data-bs-toggle="modal"
      data-bs-target="#modalAgregarEditar"
      (click)="abrirModalAgregar()"
    >
      ‚ûï Agregar Ganado
    </button>
  
    <!-- Bot√≥n para mostrar el modal de ganado cerca del l√≠mite -->
    <button class="btn btn-warning" (click)="obtenerGanadoCercaLimite()">
      üîî Ver Ganado Cerca del L√≠mite
    </button>
  
    <!-- Tabla de ganado -->
    <!-- üêÑ Tabla de Ganado Registrado -->
    <div class="table-responsive mt-4">
      <table class="table table-striped table-hover">
        <thead class="table-dark">
          <tr>
            <th>C√≥digo √önico</th>
            <th>Raza</th>
            <th>Peso (kg)</th>
            <th>Corral</th>
            <th>D√≠as Registrados</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let ganado of ganados">
            <td>{{ ganado.codigoUnico }}</td>
            <td>{{ ganado.raza }}</td>
            <td>{{ ganado.peso }}</td>
            <td>{{ ganado.corral?.nombre || "No asignado" }}</td>
            <td
              [ngClass]="{
                'text-warning fw-bold': ganado.tiempo >= 80 && ganado.tiempo < 85,
                'text-danger fw-bold': ganado.tiempo >= 85
              }"
            >
              ‚è≥ {{ ganado.tiempo }} d√≠as
            </td>
            <td>
              <button
                class="btn btn-sm btn-warning me-2"
                (click)="editarGanado(ganado)"
              >
                ‚úèÔ∏è Editar
              </button>
              <button
                class="btn btn-sm btn-danger"
                *ngIf="ganado.id !== undefined && ganado.id !== null"
                (click)="eliminarGanado(ganado.id)"
              >
                üóë Eliminar
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  
    <!-- üêÑ Modal Agregar/Editar Ganado -->
    <div
      class="modal fade"
      id="modalAgregarEditar"
      tabindex="-1"
      aria-labelledby="modalAgregarEditarLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              {{ esNuevo ? "Agregar Ganado" : "Editar Ganado" }}
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
  
          <div class="modal-body">
            <form>
              <!-- C√≥digo √önico -->
              <div class="mb-3">
                <label for="codigoUnico" class="form-label">C√≥digo √önico</label>
                <input
                  type="text"
                  class="form-control"
                  id="codigoUnico"
                  [(ngModel)]="ganadoSeleccionado.codigoUnico"
                  name="codigoUnico"
                  required
                  [ngModelOptions]="{ standalone: true }"
                />
              </div>
  
              <!-- Raza -->
              <div class="mb-3">
                <label for="raza" class="form-label">Raza</label>
                <input
                  type="text"
                  class="form-control"
                  id="raza"
                  [(ngModel)]="ganadoSeleccionado.raza"
                  name="raza"
                  required
                  [ngModelOptions]="{ standalone: true }"
                />
              </div>
  
              <!-- Peso -->
              <div class="mb-3">
                <label for="peso" class="form-label">Peso (kg)</label>
                <input
                  type="number"
                  class="form-control"
                  id="peso"
                  [(ngModel)]="ganadoSeleccionado.peso"
                  name="peso"
                  required
                  min="1"
                  [ngModelOptions]="{ standalone: true }"
                />
              </div>
  
              <!-- Establo -->
              <div class="mb-3">
                <label for="establo" class="form-label">Establo</label>
                <select
                  class="form-control"
                  id="establo"
                  [(ngModel)]="establoSeleccionado"
                  (change)="obtenerCorralesPorEstablo()"
                  name="establo"
                  required
                  [ngModelOptions]="{ standalone: true }"
                >
                  <option *ngFor="let establo of establos" [value]="establo.id">
                    {{ establo.nombre }}
                  </option>
                </select>
              </div>
  
              <!-- Corral (ComboBox) -->
              <div class="mb-3">
                <label for="corral" class="form-label">Corral</label>
                <select
                  class="form-control"
                  id="corral"
                  [(ngModel)]="ganadoSeleccionado.corral"
                  name="corral"
                  required
                  [ngModelOptions]="{ standalone: true }"
                >
                  <option *ngFor="let corral of corrales" [ngValue]="corral">
                    {{ corral.nombre }}
                  </option>
                </select>
              </div>
            </form>
          </div>
  
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-primary"
              (click)="guardarGanado()"
            >
              üíæ Guardar
            </button>
          </div>
        </div>
      </div>
    </div>
  
    <!-- üö® Modal Ganado Cerca del L√≠mite -->
    <div
    class="modal fade"
    id="modalGanadoCercaLimite"
    tabindex="-1"
    aria-labelledby="modalGanadoCercaLimiteLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title">üîî Notificaciones de Ganado</h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
  
        <div class="modal-body">
          <div class="container">
            <div class="row">
              <div class="col-12">
                <div
                  class="card mb-3"
                  *ngFor="let ganado of ganadoCercaLimite"
                  [ngClass]="{
                    'border-warning': ganado.tiempo >= 80 && ganado.tiempo < 85,
                    'border-danger': ganado.tiempo >= 85
                  }"
                >
                  <div class="card-body">
                    <div class="d-flex align-items-center">
                      <div class="me-3">
                        <i
                          class="bi bi-exclamation-triangle-fill fs-2"
                          [ngClass]="{
                            'text-warning': ganado.tiempo >= 80 && ganado.tiempo < 85,
                            'text-danger': ganado.tiempo >= 85
                          }"
                        ></i>
                      </div>
                      <div>
                        <h4
                          class="fw-bold"
                          [ngClass]="{
                            'text-warning': ganado.tiempo >= 80 && ganado.tiempo < 85,
                            'text-danger': ganado.tiempo >= 85
                          }"
                        >
                          ‚è≥ {{ ganado.tiempo }} d√≠as
                        </h4>
                        <p>
                          <strong>C√≥digo:</strong> {{ ganado.codigoUnico }} <br />
                          <strong>Raza:</strong> {{ ganado.raza }} <br />
                          <strong>Peso:</strong> {{ ganado.peso }} kg <br />
                          <strong>Corral:</strong>
                          {{ ganado.corral?.nombre || "Sin asignar" }}
                        </p>
                        <hr />
                        <small class="mb-0 text-muted"
                          >üìÖ Registrado el: {{ ganado.fechaRegistro }}</small
                        >
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
  
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Cerrar
          </button>
        </div>
      </div>
    </div>
  </div>